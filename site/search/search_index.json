{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Documentation Index","text":"<p>This is the central documentation map for HER-Ai. Use this page to navigate architecture, setup, operations, development workflow, and module-level references.</p>"},{"location":"#structured-toc","title":"Structured TOC","text":"<ul> <li> <ol> <li>Project Foundations</li> </ol> </li> <li><code>README.md</code> - project overview, quick start, contribution entry points</li> <li><code>docs/architecture.md</code> - runtime architecture, data flow, module responsibilities</li> <li><code>docs/roadmap.md</code> - 3-phase future implementation roadmap</li> <li> <ol> <li>Setup and Runtime</li> </ol> </li> <li><code>docs/installation.md</code> - platform-by-platform installation and first boot</li> <li><code>docs/configuration.md</code> - full environment and YAML configuration reference</li> <li><code>docs/usage.md</code> - user/admin workflows and command usage</li> <li><code>docs/deployment.md</code> - container deployment and production guidance</li> <li> <ol> <li>Quality and Operations</li> </ol> </li> <li><code>docs/testing.md</code> - test strategy and test authoring guidance</li> <li><code>docs/admin-tooling.md</code> - dashboard pages, CLI operations, script workflows</li> <li> <ol> <li>Examples and Team Workflow</li> </ol> </li> <li><code>docs/examples.md</code> - prompt library and scenario walkthroughs</li> <li><code>docs/developer-guidelines.md</code> - coding standards, linting, git, release flow</li> <li> <ol> <li>Folder and Code-Area Reference</li> </ol> </li> <li><code>docs/folders/her-core.md</code></li> <li><code>docs/folders/her-core-agents.md</code></li> <li><code>docs/folders/her-core-telegram.md</code></li> <li><code>docs/folders/her-core-memory.md</code></li> <li><code>docs/folders/her-core-mcp.md</code></li> <li><code>docs/folders/her-core-utils.md</code></li> <li><code>docs/folders/dashboard.md</code></li> <li><code>docs/folders/config.md</code></li> <li><code>docs/folders/sandbox.md</code></li> <li><code>docs/folders/tests.md</code></li> <li><code>docs/folders/init-scripts.md</code></li> <li><code>docs/folders/github-workflows.md</code></li> <li><code>docs/folders/docs.md</code></li> </ul>"},{"location":"#recommended-reading-paths","title":"Recommended Reading Paths","text":"<ul> <li>New contributor: <code>README.md</code> -&gt; <code>docs/installation.md</code> -&gt; <code>docs/usage.md</code> -&gt; <code>docs/developer-guidelines.md</code></li> <li>Operator/admin: <code>docs/installation.md</code> -&gt; <code>docs/configuration.md</code> -&gt; <code>docs/admin-tooling.md</code> -&gt; <code>docs/deployment.md</code></li> <li>Feature developer: <code>docs/architecture.md</code> -&gt; <code>docs/folders/her-core.md</code> -&gt; <code>docs/testing.md</code> -&gt; <code>docs/developer-guidelines.md</code></li> </ul>"},{"location":"#cross-reference-entry-points","title":"Cross-Reference Entry Points","text":"<ul> <li>Runtime bootstrap: <code>her-core/main.py</code></li> <li>Telegram handler logic: <code>her-core/her_telegram/handlers.py</code></li> <li>MCP integration: <code>her-core/her_mcp/manager.py</code></li> <li>Scheduler and task persistence: <code>her-core/utils/scheduler.py</code></li> <li>Dashboard UI and data readers: <code>dashboard/app.py</code></li> <li>Container orchestration: <code>docker-compose.yml</code></li> <li>CI workflow: <code>.github/workflows/ci.yml</code></li> </ul>"},{"location":"admin-tooling/","title":"Admin and Tooling Guide","text":""},{"location":"admin-tooling/#dashboard-operations","title":"Dashboard Operations","text":"<p>Dashboard entrypoint: <code>dashboard/app.py</code>.</p> <p>Pages and operational purpose: - Overview: KPIs, capability diagnostics, memory/system summaries - Logs: runtime logs and MCP diagnostics - Recent Chats: latest interaction traces - Executors: sandbox execution history - Jobs: scheduler state and history - Decisions: decision log audit trail - Metrics: message/token trends - Memory: memory growth/search and category insights - System Health: Redis/Postgres/runtime capability snapshot</p> <p>Access URL: <code>http://localhost:8501</code>.</p>"},{"location":"admin-tooling/#telegram-admin-commands","title":"Telegram Admin Commands","text":"<p>Handlers are implemented in <code>her-core/her_telegram/handlers.py</code>.</p> <p>Core commands: - <code>/status</code> - <code>/mcp</code> - <code>/memories</code> - <code>/personality</code> - <code>/schedule</code> - <code>/example</code></p>"},{"location":"admin-tooling/#scheduler-tooling","title":"Scheduler Tooling","text":"<p>Scheduler engine: <code>her-core/utils/scheduler.py</code>.</p> <p>Useful admin operations:</p> <pre><code>/schedule list\n/schedule set &lt;task&gt; &lt;interval&gt;\n/schedule enable &lt;task&gt;\n/schedule disable &lt;task&gt;\n/schedule run &lt;task&gt;\n/schedule add &lt;name&gt; &lt;type&gt; &lt;interval&gt; [key=value ...]\n</code></pre> <p>Persistence behavior: - primary: <code>config/scheduler.yaml</code> - fallback (if config path read-only): Redis key <code>her:scheduler:tasks_override</code></p> <p>Reminder delivery safeguards: - <code>chat_id</code> is mandatory for reminder tasks and is persisted from Telegram interactions. - <code>notify_user_id</code> must be a positive numeric Telegram chat/user id. - Invalid/missing ids fail fast and are not treated as successful sends. - Permanent Telegram delivery errors (for example <code>Chat not found</code> or bot forbidden) disable the reminder task to prevent retry loops. - Reminder states are explicit: <code>PENDING</code>, <code>RETRY</code>, <code>SENT</code>, <code>FAILED</code>.</p>"},{"location":"admin-tooling/#mcp-and-sandbox-tooling","title":"MCP and Sandbox Tooling","text":"<ul> <li>MCP startup/status: <code>her-core/her_mcp/manager.py</code></li> <li>Curated tool integration: <code>her-core/her_mcp/tools.py</code></li> <li>Sandbox command/network/security helpers: <code>her-core/her_mcp/sandbox_tools.py</code></li> </ul> <p>Runtime checks: - <code>/mcp</code> command - dashboard capability panels - <code>docker compose logs her-bot</code></p>"},{"location":"admin-tooling/#operational-cli-commands","title":"Operational CLI Commands","text":"<pre><code>docker compose ps\ndocker compose logs -f her-bot\ndocker compose logs -f dashboard\ndocker compose exec sandbox check_pentest_tools\n</code></pre>"},{"location":"architecture/","title":"Architecture Overview","text":""},{"location":"architecture/#system-layers","title":"System Layers","text":"<p>HER-Ai is organized into five layers:</p> <ol> <li>Interface layer</li> <li>Telegram bot interface (<code>her-core/her_telegram/bot.py</code>, <code>her-core/her_telegram/handlers.py</code>)</li> <li> <p>Admin dashboard (<code>dashboard/app.py</code>)</p> </li> <li> <p>Orchestration layer</p> </li> <li>Runtime composition and service boot (<code>her-core/main.py</code>)</li> <li>CrewAI agents (<code>her-core/agents/*.py</code>)</li> <li> <p>Task scheduler (<code>her-core/utils/scheduler.py</code>)</p> </li> <li> <p>Intelligence and tools layer</p> </li> <li>LLM provider factory (<code>her-core/utils/llm_factory.py</code>)</li> <li>MCP server manager (<code>her-core/her_mcp/manager.py</code>)</li> <li>Curated tool wrappers (<code>her-core/her_mcp/tools.py</code>)</li> <li> <p>Sandbox execution adapters (<code>her-core/her_mcp/sandbox_tools.py</code>)</p> </li> <li> <p>Memory and state layer</p> </li> <li>Long-term memory wrapper (<code>her-core/memory/mem0_client.py</code>)</li> <li>Short-term context cache (<code>her-core/memory/redis_client.py</code>)</li> <li>DB initialization and schema (<code>her-core/memory/db_init.py</code>, <code>her-core/memory/schemas.sql</code>)</li> <li> <p>Runtime metrics/decision logs (<code>her-core/utils/metrics.py</code>, <code>her-core/utils/decision_log.py</code>)</p> </li> <li> <p>Infrastructure layer</p> </li> <li>Compose stack (<code>docker-compose.yml</code>)</li> <li>Image definitions (<code>her-core/Dockerfile</code>, <code>dashboard/Dockerfile</code>, <code>sandbox/Dockerfile</code>)</li> <li>CI/CD (<code>.github/workflows/ci.yml</code>)</li> </ol>"},{"location":"architecture/#runtime-flow","title":"Runtime Flow","text":"<pre><code>Telegram message\n  -&gt; her_telegram.handlers.MessageHandlers\n  -&gt; strict intent classifier (CHAT_MODE default, ACTION_MODE on explicit high-confidence action intent)\n  -&gt; context update (Redis)\n  -&gt; memory lookup (Mem0/pgvector)\n  -&gt; LLM response generation (with optional failover)\n  -&gt; validated tool/sandbox action execution (immediate by default; scheduler only on explicit scheduling intent)\n  -&gt; metrics + decision logs persisted\n</code></pre>"},{"location":"architecture/#major-modules-and-responsibilities","title":"Major Modules and Responsibilities","text":"Module Responsibility Primary Files <code>her-core</code> Main assistant runtime, agents, memory, telegram handling, scheduling <code>her-core/main.py</code>, <code>her-core/her_telegram/handlers.py</code> <code>her-core/agents</code> CrewAI roles for conversation, reflection, personality, tools <code>her-core/agents/conversation_agent.py</code>, <code>her-core/agents/crew_orchestrator.py</code> <code>her-core/her_mcp</code> MCP server lifecycle, tool abstraction, sandbox utilities <code>her-core/her_mcp/manager.py</code>, <code>her-core/her_mcp/tools.py</code> <code>her-core/memory</code> Mem0 integration, context cache, schema compatibility <code>her-core/memory/mem0_client.py</code>, <code>her-core/memory/schemas.sql</code> <code>dashboard</code> Operational visibility, health and metrics UI <code>dashboard/app.py</code> <code>tests</code> Runtime guardrails and smoke checks <code>tests/test_runtime_guards.py</code>, <code>tests/test_smoke.py</code>"},{"location":"architecture/#service-topology-compose","title":"Service Topology (Compose)","text":"Service Purpose Data <code>her-bot</code> Core app runtime Redis + PostgreSQL + MCP/sandbox access <code>postgres</code> Long-term memory and logs persistent volume <code>redis</code> context and metrics cache persistent AOF volume <code>ollama</code> + <code>ollama-init</code> local model serving and model pre-pull model volume <code>sandbox</code> isolated execution tools ephemeral workspace volume <code>dashboard</code> monitoring and operations UI reads Redis/Postgres <p>Reference: <code>docker-compose.yml</code>.</p>"},{"location":"architecture/#design-notes","title":"Design Notes","text":"<ul> <li>Config resolution supports runtime volume and fallback defaults via <code>HER_CONFIG_DIR</code> (<code>her-core/utils/config_paths.py</code>).</li> <li>MCP startup is resilient to per-server failures/timeouts (<code>MCP_SERVER_START_TIMEOUT_SECONDS</code>).</li> <li>Memory reads/writes can degrade gracefully when backend is unavailable if <code>MEMORY_STRICT_MODE=false</code>.</li> <li>Scheduler tasks persist to YAML and fallback to Redis override if config path is not writable.</li> </ul>"},{"location":"configuration/","title":"Configuration Manual","text":"<p>Configuration is driven by environment variables in <code>.env</code> and YAML files under <code>config/</code>.</p>"},{"location":"configuration/#environment-variables-reference","title":"Environment Variables Reference","text":"Variable Default Description <code>LLM_PROVIDER</code> <code>ollama</code> Primary chat provider (<code>ollama</code>, <code>openai</code>, <code>groq</code>, <code>openrouter</code>) <code>LLM_ENABLE_FALLBACK</code> <code>true</code> Enable secondary provider failover for transient upstream errors <code>LLM_FALLBACK_PROVIDER</code> <code>ollama</code> Provider used when primary fails with 502/503 path <code>OLLAMA_MODEL</code> <code>llama3.2:3b</code> Chat model for Ollama provider <code>OLLAMA_BASE_URL</code> <code>http://ollama:11434</code> Ollama service base URL <code>OLLAMA_HOST</code> <code>http://ollama:11434</code> Alternate Ollama endpoint for tooling/init scripts <code>OLLAMA_EMBED_MODEL</code> <code>nomic-embed-text</code> Embedding model pulled by <code>ollama-init</code> <code>OPENAI_API_KEY</code> - OpenAI API key <code>OPENAI_MODEL</code> <code>gpt-4o-mini</code> OpenAI model name <code>GROQ_API_KEY</code> - Groq API key <code>GROQ_MODEL</code> <code>llama-3.3-70b-versatile</code> Groq model <code>GROQ_API_BASE</code> <code>https://api.groq.com/openai/v1</code> Groq OpenAI-compatible endpoint <code>OPENROUTER_API_KEY</code> - OpenRouter API key <code>OPENROUTER_MODEL</code> <code>meta-llama/llama-3.3-70b-instruct</code> OpenRouter model <code>OPENROUTER_API_BASE</code> <code>https://openrouter.ai/api/v1</code> OpenRouter API endpoint <code>MEMORY_VECTOR_PROVIDER</code> <code>pgvector</code> Mem0 vector store provider <code>MEMORY_COLLECTION_NAME</code> <code>memories</code> Collection/table name <code>MEMORY_STRICT_MODE</code> <code>false</code> If true, memory backend errors are fatal <code>EMBEDDER_PROVIDER</code> <code>ollama</code> Embedder backend (<code>openai</code> or <code>ollama</code>) <code>EMBEDDING_MODEL</code> <code>nomic-embed-text</code> Embedding model name <code>EMBEDDING_DIMENSIONS</code> <code>768</code> Embedding vector dimensions <code>POSTGRES_USER</code> <code>her</code> PostgreSQL username <code>POSTGRES_PASSWORD</code> <code>changeme123</code> PostgreSQL password <code>POSTGRES_DB</code> <code>her_memory</code> PostgreSQL database <code>POSTGRES_HOST</code> <code>postgres</code> PostgreSQL host <code>POSTGRES_PORT</code> <code>5432</code> PostgreSQL port <code>POSTGRES_URL</code> <code>postgresql://...</code> DSN for MCP postgres server <code>REDIS_HOST</code> <code>redis</code> Redis host <code>REDIS_PORT</code> <code>6379</code> Redis port <code>REDIS_PASSWORD</code> <code>changeme456</code> Redis password <code>LOG_LEVEL</code> <code>INFO</code> Application log level <code>ENVIRONMENT</code> <code>development</code> Environment label <code>TZ</code> <code>UTC</code> Global timezone <code>USER_TIMEZONE</code> <code>UTC</code> Default user timezone for reminder parsing/display <code>STARTUP_WARMUP_ENABLED</code> <code>false</code> Optional startup warmup compatibility check <code>WORKFLOW_DEBUG_SERVER_ENABLED</code> <code>true</code> Enable realtime workflow DAG server <code>WORKFLOW_DEBUG_HOST</code> <code>0.0.0.0</code> Workflow debug server bind host <code>WORKFLOW_DEBUG_PORT</code> <code>8081</code> Workflow debug server port <code>API_ADAPTER_ENABLED</code> <code>true</code> Enable HTTP OpenAPI adapter <code>API_ADAPTER_HOST</code> <code>0.0.0.0</code> OpenAPI adapter bind host <code>API_ADAPTER_PORT</code> <code>8082</code> OpenAPI adapter port <code>API_ADAPTER_BEARER_TOKEN</code> `` Optional bearer token required by API adapter endpoints <code>API_ADAPTER_MODEL_NAME</code> <code>her-chat-1</code> OpenAI-compatible model id exposed by <code>/v1/models</code> <code>TELEGRAM_ENABLED</code> <code>true</code> Enable/disable Telegram polling <code>TELEGRAM_BOT_TOKEN</code> - Telegram bot token <code>TELEGRAM_STARTUP_RETRY_DELAY_SECONDS</code> <code>10</code> Retry delay for transient Telegram network errors <code>ADMIN_USER_ID</code> - Comma-safe admin ID list source (single env entry accepted) <code>TELEGRAM_PUBLIC_APPROVAL_REQUIRED</code> <code>true</code> Require approval for public users <code>TELEGRAM_PUBLIC_RATE_LIMIT_PER_MINUTE</code> <code>20</code> Public user rate limit <code>HER_AUTONOMOUS_MAX_STEPS</code> <code>16</code> Max autonomous action steps per request <code>HER_SANDBOX_COMMAND_TIMEOUT_SECONDS</code> <code>60</code> Sandbox command timeout <code>HER_ACTION_INTENT_THRESHOLD</code> <code>0.8</code> Minimum confidence required to switch from chat mode to action mode <code>HER_SANDBOX_CPU_TIME_LIMIT_SECONDS</code> <code>20</code> Sandbox CPU time cap <code>HER_SANDBOX_MEMORY_LIMIT_MB</code> <code>512</code> Sandbox memory cap <code>MCP_CONFIG_PATH</code> <code>mcp_servers.yaml</code> MCP profile file name <code>MCP_SERVER_START_TIMEOUT_SECONDS</code> <code>60</code> Timeout per MCP server startup <code>SANDBOX_CONTAINER_NAME</code> <code>her-sandbox</code> Container target for sandbox tools <code>HER_CONFIG_DIR</code> <code>/app/config</code> Runtime config directory override <code>DOCKER_GID</code> <code>998</code> Optional docker group id when non-root runtime <code>BRAVE_API_KEY</code> - Optional Brave Search MCP key"},{"location":"configuration/#yaml-configuration-files","title":"YAML Configuration Files","text":"File Purpose <code>config/agents.yaml</code> CrewAI agent role/goal/backstory and runtime settings <code>config/personality.yaml</code> default traits and immutable values <code>config/memory.yaml</code> short/long-term memory limits and dimensions <code>config/telegram.yaml</code> commands, feature flags, admin list <code>config/rate_limits.yaml</code> public/admin rate-limit behavior <code>config/scheduler.yaml</code> recurring and one-off task definitions <code>config/mcp_servers.yaml</code> default MCP profile <code>config/mcp_servers.local.yaml</code> local no-key MCP profile <code>config/twitter.yaml</code> optional twitter automation settings"},{"location":"configuration/#config-resolution-order","title":"Config Resolution Order","text":"<p>Resolved by <code>her-core/utils/config_paths.py</code>: 1. <code>HER_CONFIG_DIR</code> 2. <code>/app/config</code> or <code>/app/config.defaults</code> (order depends on writability) 3. repository <code>config/</code> 4. current working directory <code>config/</code></p>"},{"location":"configuration/#configuration-change-workflow","title":"Configuration Change Workflow","text":"<ol> <li>Update <code>.env</code> and/or <code>config/*.yaml</code>.</li> <li>Keep <code>.env.example</code> aligned if introducing variables.</li> <li>Restart affected services:</li> </ol> <pre><code>docker compose up -d --build her-bot dashboard\n</code></pre> <ol> <li>Verify with <code>/status</code>, <code>/mcp</code>, dashboard pages, and service logs.</li> </ol>"},{"location":"dashboard/","title":"HER Admin Dashboard","text":"<p>The HER Admin Dashboard is a comprehensive Streamlit application that provides real-time monitoring, logging, and management capabilities for the HER AI Assistant system.</p> <p>Charts use Plotly for responsive, interactive visuals (zoom, pan, hover, legend toggles).</p>"},{"location":"dashboard/#features","title":"Features","text":""},{"location":"dashboard/#overview-dashboard","title":"\ud83d\udcca Overview Dashboard","text":"<ul> <li>Key Metrics: Total messages, tokens, users, memories at a glance</li> <li>Capability Diagnostics: Internet/sandbox/MCP status with reasons, server table, and startup history trend</li> <li>MCP Failure Report: Error counts by server and top recurring failure messages</li> <li>Traffic &amp; Log Trends: Messages/tokens over time and log-level distribution charts</li> <li>Memory Summary: Side-by-side short-memory (Redis) and long-memory (PostgreSQL) health cards</li> <li>System Status: Service connectivity and environment info</li> </ul>"},{"location":"dashboard/#logs-page","title":"\ud83d\udccb Logs Page","text":"<ul> <li>Real-time System Logs: View all application logs from Redis</li> <li>Filtering: Filter by log level (INFO, WARNING, ERROR, DEBUG)</li> <li>Search: Search logs by keyword</li> <li>MCP Error Analytics: Dedicated diagnostics for MCP startup/JSON-RPC failures</li> <li>Auto-refresh: Automatically update logs at configurable intervals</li> </ul>"},{"location":"dashboard/#recent-chats-page","title":"\ud83d\udcac Recent Chats Page","text":"<ul> <li>Recent Interaction Events: User messages + assistant responses from <code>her:metrics:events</code></li> <li>Redis Context Threads: Latest context snippets from <code>her:context:*</code></li> <li>Quick Debugging: Validate whether chat history is being persisted</li> <li>Redis Type Safe: Context reads support both string-backed JSON threads and list-backed legacy keys without <code>WRONGTYPE</code> errors</li> </ul>"},{"location":"dashboard/#executors-page","title":"\ud83d\udd27 Executors Page","text":"<ul> <li>Sandbox Execution History: View all sandbox command executions</li> <li>Execution Details: Command, output, errors, execution time, exit codes</li> <li>Statistics: Success rate, total executions, performance metrics</li> <li>Filtering: Filter by success/failure status</li> </ul>"},{"location":"dashboard/#jobs-page","title":"\u23f0 Jobs Page","text":"<ul> <li>Scheduled Job History: View all scheduled task executions</li> <li>Upcoming Jobs: Live upcoming schedule from <code>her:scheduler:state</code></li> <li>Job Details: Name, type, interval, execution time, results</li> <li>Job Configuration: View and manage scheduled tasks</li> <li>Next Run Times: See when jobs will execute next</li> </ul>"},{"location":"dashboard/#decisions-page","title":"\ud83e\uddfe Decisions Page","text":"<ul> <li>Decision Audit Trail: View runtime decisions and actions from Redis key <code>her:decision:logs</code></li> <li>Transparency Metrics: Breakdown of decision event types (scheduler, capability probes, reply generation)</li> <li>Debugging Support: Correlate decisions with logs and job outcomes</li> <li>Reinforcement Traceability: Reinforcement scoring decisions appear as <code>reinforcement_event</code> entries</li> </ul>"},{"location":"dashboard/#metrics-page","title":"\ud83d\udcc8 Metrics Page","text":"<ul> <li>Token Usage Over Time: Visual chart of token consumption</li> <li>Message Statistics: Detailed message and user metrics</li> <li>Recent Interactions: Table of recent user interactions</li> <li>Performance Metrics: Response times and system performance</li> </ul>"},{"location":"dashboard/#memory-page","title":"\ud83d\udcbe Memory Page","text":"<ul> <li>Short Memory Report: Redis context thread totals, role distribution, largest threads</li> <li>Long Memory Report: Totals, 24h growth, average importance, top users</li> <li>Category Breakdown: Visual charts of long-memory categories</li> <li>Memory Creation Trends: Daily long-memory creation over last 30 days</li> <li>Recent Long-Memory Feed: Latest persisted memory rows</li> <li>Memory Search: Search memories by keyword with full-text search</li> <li>Schema Compatibility: Supports both legacy memory schema and Mem0 payload schema</li> </ul>"},{"location":"dashboard/#system-health-page","title":"\ud83c\udfe5 System Health Page","text":"<ul> <li>Service Status: Redis and PostgreSQL connectivity</li> <li>Service Information: Version info, memory usage, connection status</li> <li>Environment Info: Configuration and environment variables</li> <li>Health Checks: Real-time service health monitoring</li> <li>Runtime Snapshot: Raw startup capability payload from <code>her:runtime:capabilities</code></li> </ul>"},{"location":"dashboard/#workflow-debugger-realtime-dag","title":"\ud83e\udde0 Workflow Debugger (Realtime DAG)","text":"<ul> <li>WebSocket Event Stream: <code>ws://localhost:8081/ws/workflow</code></li> <li>Execution Graph: Input \u2192 Intent Classifier \u2192 Memory Lookup \u2192 Tool Selector \u2192 Tool Executor/LLM \u2192 Response</li> <li>Timeline + Latency: Node durations and total request latency</li> <li>Live Console: Streaming tool stdout/stderr and stage transitions</li> <li>Debug Toggle: <code>http://localhost:8081/workflow?debug=true</code> reveals raw LLM prompts + tool I/O</li> </ul>"},{"location":"dashboard/#access","title":"Access","text":"<p>The dashboard runs on port <code>8501</code> and is accessible at:</p> <pre><code>http://localhost:8501\n</code></pre> <p>Realtime workflow debugger:</p> <pre><code>http://localhost:8081/workflow\n</code></pre>"},{"location":"dashboard/#configuration","title":"Configuration","text":"<p>The dashboard automatically connects to: - Redis: For metrics, logs, and execution history - PostgreSQL: For memory statistics and search</p> <p>Configure these in your <code>.env</code> file:</p> <pre><code>REDIS_HOST=redis\nREDIS_PORT=6379\nREDIS_PASSWORD=your_password\n\nPOSTGRES_HOST=postgres\nPOSTGRES_PORT=5432\nPOSTGRES_USER=her\nPOSTGRES_PASSWORD=your_password\nPOSTGRES_DB=her_memory\nTZ=UTC\nUSER_TIMEZONE=UTC\n</code></pre>"},{"location":"dashboard/#data-sources","title":"Data Sources","text":""},{"location":"dashboard/#redis-keys","title":"Redis Keys","text":"<ul> <li><code>her:metrics:tokens</code> - Total token count</li> <li><code>her:metrics:messages</code> - Total message count</li> <li><code>her:metrics:users</code> - Set of unique user IDs</li> <li><code>her:metrics:events</code> - List of recent interactions (last 50)</li> <li><code>her:metrics:last_response</code> - Most recent response data</li> <li><code>her:logs</code> - System logs (last 200)</li> <li><code>her:sandbox:executions</code> - Sandbox execution history (last 100)</li> <li><code>her:decision:logs</code> with <code>event_type=sandbox_execution</code> - Fallback sandbox execution feed when direct list entries are unavailable</li> <li><code>her:scheduler:jobs</code> - Scheduled job history (last 100)</li> <li><code>her:scheduler:state</code> - Scheduler runtime state and upcoming jobs</li> <li><code>her:decision:logs</code> with <code>event_type=reminder_state_change</code> - Reminder lifecycle transitions</li> <li><code>her:decision:logs</code> with <code>event_type=timezone_conversion</code> - Reminder local-time to UTC conversion audit</li> <li><code>her:decision:logs</code> - Runtime decision log feed (last 500)</li> <li><code>her:reinforcement:events</code> - Reinforcement score/event history (last 1000)</li> <li><code>her:runtime:capabilities</code> - Latest startup capability snapshot (internet/sandbox/MCP)</li> <li><code>her:runtime:capabilities:history</code> - Capability snapshot history (last 100)</li> </ul>"},{"location":"dashboard/#postgresql-tables","title":"PostgreSQL Tables","text":"<ul> <li><code>memories</code> - Long-term memory storage</li> <li>Memory statistics and search queries</li> <li><code>conversation_logs</code> - Optional conversation timeline (if enabled by runtime)</li> </ul>"},{"location":"dashboard/#auto-refresh","title":"Auto-Refresh","text":"<p>The dashboard supports auto-refresh: - Enable/disable in sidebar - Configurable refresh interval (1-60 seconds) - Manual refresh button available</p>"},{"location":"dashboard/#usage-tips","title":"Usage Tips","text":"<ol> <li>Monitor Logs: Use the Logs page to debug issues and monitor system activity</li> <li>Track Executions: Check Executors page to see what commands are running in sandbox</li> <li>Job Management: Use Jobs page to monitor scheduled tasks and their execution history</li> <li>Memory Insights: Use Memory page to understand what HER is remembering</li> <li>Health Monitoring: Check System Health page regularly to ensure all services are running</li> </ol>"},{"location":"dashboard/#troubleshooting","title":"Troubleshooting","text":""},{"location":"dashboard/#dashboard-not-loading","title":"Dashboard not loading","text":"<ul> <li>Check that Redis and PostgreSQL are running</li> <li>Verify environment variables are set correctly</li> <li>Check dashboard logs: <code>docker compose logs dashboard</code></li> </ul>"},{"location":"dashboard/#no-data-showing","title":"No data showing","text":"<ul> <li>Ensure HER bot is running and generating metrics</li> <li>Check Redis connectivity</li> <li>Verify PostgreSQL connection</li> </ul>"},{"location":"dashboard/#logs-not-appearing","title":"Logs not appearing","text":"<ul> <li>Ensure Redis log handler is enabled in main.py</li> <li>Check Redis key <code>her:logs</code> exists</li> <li>Verify log level is set appropriately</li> </ul>"},{"location":"dashboard/#related-documentation","title":"Related Documentation","text":"<ul> <li>Architecture Overview</li> <li>MCP Integration Guide</li> <li>Testing Playbook</li> </ul>"},{"location":"deployment/","title":"Deployment Guide","text":""},{"location":"deployment/#deployment-modes","title":"Deployment Modes","text":"<ul> <li>Local/staging with <code>docker compose</code></li> <li>Production-like deployment with prebuilt images from GHCR</li> </ul>"},{"location":"deployment/#container-build-and-run","title":"Container Build and Run","text":"<p>Build images:</p> <pre><code>docker compose build her-bot dashboard sandbox\n</code></pre> <p>Run services:</p> <pre><code>docker compose up -d\n</code></pre> <p>Validate:</p> <pre><code>docker compose ps\ncurl -sS http://localhost:8000\n</code></pre>"},{"location":"deployment/#production-recommendations","title":"Production Recommendations","text":"<ol> <li>Use immutable image tags (release tags) instead of <code>latest</code>.</li> <li>Store secrets in external secret manager or protected env system.</li> <li>Restrict network exposure to required ports.</li> <li>Enable log collection and retention for <code>her-bot</code> and <code>dashboard</code>.</li> <li>Backup Postgres and Redis volumes.</li> <li>Track MCP availability and scheduler task health in dashboard pages.</li> </ol>"},{"location":"deployment/#environment-hardening","title":"Environment Hardening","text":"<ul> <li>Set strong DB/Redis credentials.</li> <li>Review <code>MCP_CONFIG_PATH</code> and disable unneeded servers.</li> <li>Keep sandbox limits (<code>HER_SANDBOX_*</code>) conservative in shared environments.</li> <li>Run with explicit timezone (<code>TZ</code>) and operational alerts.</li> </ul>"},{"location":"deployment/#cicd-and-image-publishing","title":"CI/CD and Image Publishing","text":"<p><code>.github/workflows/ci.yml</code> builds and publishes: - <code>ghcr.io/&lt;owner&gt;/her-ai/her-bot</code> - <code>ghcr.io/&lt;owner&gt;/her-ai/her-dashboard</code> - <code>ghcr.io/&lt;owner&gt;/her-ai/her-sandbox</code></p> <p>Docs are built with MkDocs and deployed to GitHub Pages when <code>main</code> updates.</p>"},{"location":"deployment/#operational-runbook-minimal","title":"Operational Runbook (Minimal)","text":"<ol> <li>Pull latest stable images.</li> <li>Update <code>.env</code> and config files.</li> <li>Start services with compose.</li> <li>Confirm health endpoint and dashboard.</li> <li>Test <code>/status</code> and <code>/mcp</code> in Telegram.</li> <li>Review logs for startup capability warnings.</li> </ol>"},{"location":"developer-guidelines/","title":"Developer Guidelines","text":""},{"location":"developer-guidelines/#engineering-standards","title":"Engineering Standards","text":"<ul> <li>Keep behavioral changes aligned across runtime, dashboard, config, tests, and docs.</li> <li>Prefer small, reviewable commits.</li> <li>Add tests for behavior changes.</li> <li>Keep <code>.env.example</code> synchronized when adding env variables.</li> </ul>"},{"location":"developer-guidelines/#code-quality","title":"Code Quality","text":"<ul> <li>Python style: clear naming, modular functions, explicit error handling.</li> <li>Avoid hidden side effects in handlers/scheduler flows.</li> <li>Keep backward compatibility for config resolution and startup behavior where practical.</li> </ul>"},{"location":"developer-guidelines/#linting-and-formatting","title":"Linting and Formatting","text":"<p>This repository currently enforces tests in CI. If you add local lint tooling, document commands and keep CI aligned.</p> <p>Minimum pre-PR checks:</p> <pre><code>pytest -q\n</code></pre>"},{"location":"developer-guidelines/#git-workflow","title":"Git Workflow","text":"<ol> <li>Create branch from <code>main</code>.</li> <li>Implement code + tests + docs together.</li> <li>Re-run tests.</li> <li>Open PR with change summary and test evidence.</li> </ol> <p>Recommended PR template sections: - Scope - Behavior changes - Config/docs changes - Tests run - Risks/rollback notes</p>"},{"location":"developer-guidelines/#release-process","title":"Release Process","text":"<p>CI workflow (<code>.github/workflows/ci.yml</code>) handles: 1. test job 2. image build/publish to GHCR 3. docs build/deploy (main branch)</p> <p>For tagged releases: - push semantic tag (<code>vX.Y.Z</code>) - verify GHCR images and docs deployment - publish release notes with migration/config notes</p>"},{"location":"developer-guidelines/#documentation-rules","title":"Documentation Rules","text":"<ul> <li>Update <code>README.md</code> for top-level behavior/config/runtime changes.</li> <li>Update relevant files under <code>docs/</code> for module-level changes.</li> <li>Keep cross-references to source files accurate.</li> </ul>"},{"location":"examples/","title":"Example Scenarios and Prompt Library","text":"<p>The prompt library is designed for onboarding, validation, and regression testing of assistant behavior.</p>"},{"location":"examples/#library-structure","title":"Library Structure","text":"<p>Prompt categories mirror in-code examples in <code>her-core/her_telegram/handlers.py</code> (<code>_EXAMPLE_PROMPTS</code>): - chat - memory - scheduling - automation - web - mcp_tools - sandbox - admin - personality - productivity</p> <p>Telegram shortcuts: - <code>/example</code> - <code>/example all</code> - <code>/example &lt;topic&gt;</code></p>"},{"location":"examples/#example-scenarios","title":"Example Scenarios","text":""},{"location":"examples/#1-conversational-continuity","title":"1. Conversational continuity","text":"<pre><code>Remember that I prefer concise replies.\nWhat should I focus on this afternoon?\n</code></pre>"},{"location":"examples/#2-reminder-scheduling","title":"2. Reminder scheduling","text":"<pre><code>Remind me in 45 minutes to send the draft.\n</code></pre>"},{"location":"examples/#3-rule-based-automation","title":"3. Rule-based automation","text":"<pre><code>Check BTC every 5 minutes and notify me if it rises 8%.\n</code></pre>"},{"location":"examples/#4-tool-assisted-diagnostics","title":"4. Tool-assisted diagnostics","text":"<pre><code>Check SSL expiry for github.com and summarize result.\n</code></pre>"},{"location":"examples/#5-admin-operations","title":"5. Admin operations","text":"<pre><code>/schedule list\n/mcp\n</code></pre>"},{"location":"examples/#prompt-quality-guidelines","title":"Prompt Quality Guidelines","text":"<ul> <li>Be explicit about timeframe, threshold, and expected output format.</li> <li>For workflows, include source URL and clear condition.</li> <li>For diagnostics, specify host/domain and desired summary level.</li> </ul>"},{"location":"installation/","title":"Installation and Setup Guide","text":""},{"location":"installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker Engine or Docker Desktop with Compose v2</li> <li>Git</li> <li>Internet access for dependency pulls</li> <li>Telegram Bot Token</li> </ul> <p>Recommended host resources: - 4+ CPU cores - 8+ GB RAM (increase for larger local models)</p>"},{"location":"installation/#universal-setup-all-platforms","title":"Universal Setup (All Platforms)","text":"<ol> <li>Clone repository</li> </ol> <pre><code>git clone https://github.com/vaheed/HER-Ai.git\ncd HER-Ai\n</code></pre> <ol> <li>Create environment file</li> </ol> <pre><code>cp .env.example .env\n</code></pre> <ol> <li>Set required variables in <code>.env</code></li> <li><code>TELEGRAM_BOT_TOKEN</code></li> <li><code>ADMIN_USER_ID</code></li> <li> <p>LLM provider values (<code>LLM_PROVIDER</code> and matching API/model vars)</p> </li> <li> <p>Start stack</p> </li> </ol> <pre><code>docker compose up -d --build\n</code></pre> <ol> <li>Validate startup</li> </ol> <pre><code>docker compose ps\ncurl -sS http://localhost:8000\ncurl -sS http://localhost:8081/workflow/health\ncurl -sS http://localhost:8082/api/health\n</code></pre>"},{"location":"installation/#platform-specific-notes","title":"Platform-Specific Notes","text":""},{"location":"installation/#macos","title":"macOS","text":"<ul> <li>Use Docker Desktop.</li> <li>Increase memory allocation in Docker Desktop settings if Ollama model load fails.</li> <li>Access dashboard: <code>http://localhost:8501</code>.</li> <li>OpenAPI docs: <code>http://localhost:8082/api/docs</code>.</li> </ul>"},{"location":"installation/#linux","title":"Linux","text":"<ul> <li>Install Docker Engine + Compose plugin.</li> <li>Ensure current user can run Docker (docker group) or run commands via sudo.</li> <li>If running rootless Docker, validate socket mapping behavior for sandbox access.</li> </ul>"},{"location":"installation/#windows","title":"Windows","text":"<ul> <li>Recommended: Docker Desktop + WSL2 backend.</li> <li>Run commands in WSL terminal for path consistency.</li> <li>Ensure port mappings <code>8000</code>, <code>8501</code>, <code>11434</code> are available.</li> <li>Ensure port mapping <code>8081</code> is available if workflow debugger is enabled.</li> <li>Ensure port mapping <code>8082</code> is available if OpenAPI adapter is enabled.</li> </ul>"},{"location":"installation/#optional-local-no-docker-setup","title":"Optional Local (No Docker) Setup","text":"<p>Not the primary path, but useful for debugging: - Python 3.11 virtualenv - local PostgreSQL + pgvector - local Redis - Node.js/npm for MCP dependencies</p> <p>Install runtime deps:</p> <pre><code>pip install -r her-core/requirements.txt\n</code></pre> <p>Run tests:</p> <pre><code>pytest -q\n</code></pre>"},{"location":"installation/#first-run-checks","title":"First-Run Checks","text":"<ul> <li>Bot service logs: <code>docker compose logs --tail=200 her-bot</code></li> <li>Dashboard logs: <code>docker compose logs --tail=200 dashboard</code></li> <li>Sandbox tool check: <code>docker compose exec sandbox check_pentest_tools</code></li> </ul>"},{"location":"installation/#connect-openwebui-openai-compatible","title":"Connect OpenWebUI (OpenAI-Compatible)","text":"<p>HER exposes OpenAI-style endpoints for easy UI integration: - <code>GET /v1/models</code> - <code>POST /v1/chat/completions</code></p> <p>Base URL:</p> <pre><code>http://localhost:8082\n</code></pre> <p>OpenWebUI provider setup: 1. Set API base URL to <code>http://host.docker.internal:8082</code> when OpenWebUI runs in Docker (or <code>http://localhost:8082</code> when local). 2. Set API key:    - If <code>API_ADAPTER_BEARER_TOKEN</code> is set in HER, use the same value.    - If empty, you can use any placeholder key. 3. Select model: <code>her-chat-1</code> (or your <code>API_ADAPTER_MODEL_NAME</code>).</p> <p>Quick connectivity checks:</p> <pre><code>curl -sS http://localhost:8082/v1/models\ncurl -sS http://localhost:8082/v1/chat/completions \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer $API_ADAPTER_BEARER_TOKEN\" \\\n  -d '{\"model\":\"her-chat-1\",\"messages\":[{\"role\":\"user\",\"content\":\"hello\"}]}'\n</code></pre>"},{"location":"installation/#troubleshooting-quick-list","title":"Troubleshooting Quick List","text":"<ul> <li><code>her-bot</code> not healthy: check env vars and Postgres/Redis health in <code>docker compose ps</code>.</li> <li>MCP servers unavailable: check <code>MCP_CONFIG_PATH</code> and required env placeholders.</li> <li>Memory failures with Ollama: reduce model size or increase memory; use fallback behavior (<code>MEMORY_STRICT_MODE=false</code>).</li> </ul>"},{"location":"mcp_guide/","title":"MCP Guide","text":""},{"location":"mcp_guide/#purpose","title":"Purpose","text":"<p>HER-Ai uses MCP (Model Context Protocol) to connect runtime agents to external tools in a standardized way.</p> <p>Core implementation: - Manager: <code>her-core/her_mcp/manager.py</code> - Tool integration: <code>her-core/her_mcp/tools.py</code> - Helper wrappers: <code>her-core/her_mcp/helpers.py</code></p>"},{"location":"mcp_guide/#profiles","title":"Profiles","text":"<ul> <li>Default profile: <code>config/mcp_servers.yaml</code></li> <li>Local no-key profile: <code>config/mcp_servers.local.yaml</code></li> </ul> <p>Select profile with: - <code>MCP_CONFIG_PATH=mcp_servers.yaml</code> - or <code>MCP_CONFIG_PATH=mcp_servers.local.yaml</code></p>"},{"location":"mcp_guide/#startup-behavior","title":"Startup Behavior","text":"<ul> <li>Each enabled server is started with per-server timeout (<code>MCP_SERVER_START_TIMEOUT_SECONDS</code>).</li> <li>Missing required env placeholders mark server as unavailable instead of crashing full startup.</li> <li>Status is exposed in <code>/mcp</code> and dashboard runtime capability views.</li> </ul>"},{"location":"mcp_guide/#common-troubleshooting","title":"Common Troubleshooting","text":"<ol> <li>Server unavailable due to missing command</li> <li> <p>ensure Node/npm available in runtime image (already included in <code>her-core/Dockerfile</code>)</p> </li> <li> <p>Unresolved env placeholders</p> </li> <li> <p>define variables referenced in MCP profile (for example <code>POSTGRES_URL</code>)</p> </li> <li> <p>Timeout at startup</p> </li> <li>increase <code>MCP_SERVER_START_TIMEOUT_SECONDS</code> if needed and check network/npm availability</li> </ol>"},{"location":"phase1_prompt/","title":"HER Phase 1 - Foundation Build Prompt","text":"<p>Copy this prompt to Claude/ChatGPT to generate the complete Phase 1 project structure</p>"},{"location":"phase1_prompt/#objective","title":"\ud83c\udfaf Objective","text":"<p>Build Phase 1 (Weeks 1-3) of the HER AI Assistant: complete Docker infrastructure, memory system (Mem0 + PostgreSQL + Redis), and CrewAI agent architecture. Make it 100% functional and ready for Telegram integration.</p>"},{"location":"phase1_prompt/#project-structure-required","title":"\ud83d\udce6 Project Structure Required","text":"<pre><code>HER-Ai/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 .env.example\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 her-core/\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u251c\u2500\u2500 requirements.txt\n\u2502   \u251c\u2500\u2500 main.py\n\u2502   \u251c\u2500\u2500 config.py\n\u2502   \u251c\u2500\u2500 memory/\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 mem0_client.py\n\u2502   \u2502   \u251c\u2500\u2500 redis_client.py\n\u2502   \u2502   \u2514\u2500\u2500 schemas.sql\n\u2502   \u251c\u2500\u2500 agents/\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 conversation_agent.py\n\u2502   \u2502   \u251c\u2500\u2500 reflection_agent.py\n\u2502   \u2502   \u251c\u2500\u2500 personality_agent.py\n\u2502   \u2502   \u2514\u2500\u2500 base_agent.py\n\u2502   \u2514\u2500\u2500 utils/\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u2514\u2500\u2500 llm_factory.py\n\u251c\u2500\u2500 config/\n\u2502   \u251c\u2500\u2500 agents.yaml\n\u2502   \u251c\u2500\u2500 personality.yaml\n\u2502   \u2514\u2500\u2500 memory.yaml\n\u2514\u2500\u2500 init-scripts/\n    \u2514\u2500\u2500 init-db.sql\n</code></pre>"},{"location":"phase1_prompt/#technical-requirements","title":"\ud83d\udd27 Technical Requirements","text":""},{"location":"phase1_prompt/#1-docker-compose-setup","title":"1. Docker Compose Setup","text":"<p>Create <code>docker-compose.yml</code> with: - her-bot: Python 3.11-slim, expose port 8000 for health checks - postgres: pgvector/pgvector:pg16, persistent volume - redis: redis:7-alpine with password auth, AOF persistence - her-network: bridge network for all services - Health checks for all containers - Auto-restart policies</p>"},{"location":"phase1_prompt/#2-postgresql-database","title":"2. PostgreSQL Database","text":"<p>Initialize with <code>init-scripts/init-db.sql</code>:</p> <pre><code>-- Install pgvector extension\nCREATE EXTENSION IF NOT EXISTS vector;\n\n-- Tables needed:\n-- 1. users (user_id, username, mode, created_at, last_interaction, preferences JSONB)\n-- 2. memories (memory_id UUID, user_id, memory_text, embedding vector(1536), category, importance_score, created_at, metadata JSONB)\n-- 3. personality_states (state_id, user_id, warmth, curiosity, assertiveness, humor, emotional_depth, version, created_at, changes JSONB)\n-- 4. conversation_logs (log_id UUID, user_id, role, message, timestamp, metadata JSONB)\n\n-- Create indexes:\n-- - Vector similarity index on memories.embedding (ivfflat)\n-- - B-tree indexes on user_id, created_at, importance_score\n</code></pre>"},{"location":"phase1_prompt/#3-memory-system-mem0","title":"3. Memory System (Mem0)","text":"<p>File: <code>her-core/memory/mem0_client.py</code></p> <p>Implement <code>HERMemory</code> class: - Initialize Mem0 with pgvector backend (PostgreSQL) - Redis cache layer with 24h TTL - Methods:   - <code>add_memory(user_id, text, category, importance)</code> \u2192 stores with embedding   - <code>search_memories(user_id, query, limit=5)</code> \u2192 semantic search   - <code>get_context(user_id)</code> \u2192 fetch from Redis   - <code>update_context(user_id, message, role)</code> \u2192 store last 20 messages in Redis - Use <code>text-embedding-3-small</code> model for embeddings</p> <p>File: <code>her-core/memory/redis_client.py</code> - Simple Redis wrapper for context storage - JSON serialization/deserialization - TTL management (86400 seconds)</p>"},{"location":"phase1_prompt/#4-crewai-agents","title":"4. CrewAI Agents","text":"<p>File: <code>her-core/agents/base_agent.py</code> - Base agent class with common LLM initialization - Load config from YAML files - Error handling wrapper</p> <p>File: <code>her-core/agents/conversation_agent.py</code></p> <pre><code>from crewai import Agent\n# Role: \"Empathetic Conversationalist\"\n# Goal: \"Engage users warmly while remembering context\"\n# Tools: [memory_search] (for now)\n# LLM: OpenAI GPT-4-turbo or Groq llama3-70b (from env)\n</code></pre> <p>File: <code>her-core/agents/reflection_agent.py</code></p> <pre><code>from crewai import Agent\n# Role: \"Memory Curator\"  \n# Goal: \"Analyze conversations and store important memories\"\n# No tools needed yet\n# LLM: GPT-4-turbo or Groq mixtral\n# Method: analyze_conversation(messages) \u2192 returns memories to store\n</code></pre> <p>File: <code>her-core/agents/personality_agent.py</code></p> <pre><code>from crewai import Agent\n# Role: \"Personality Manager\"\n# Goal: \"Track and evolve personality traits safely\"\n# Stores: {warmth: 75, curiosity: 80, assertiveness: 60, humor: 70, emotional_depth: 85}\n# Methods: \n#   - get_current_traits(user_id)\n#   - adjust_trait(user_id, trait_name, delta) with bounds [20, 95]\n#   - save_version(user_id, traits, notes)\n</code></pre>"},{"location":"phase1_prompt/#5-llm-factory","title":"5. LLM Factory","text":"<p>File: <code>her-core/utils/llm_factory.py</code></p> <pre><code># Support OpenAI and Groq providers\n# Read from environment: LLM_PROVIDER, OPENAI_API_KEY, GROQ_API_KEY\n# Return configured LLM object for CrewAI\n# Default: OpenAI gpt-4-turbo-preview\n</code></pre>"},{"location":"phase1_prompt/#6-main-application","title":"6. Main Application","text":"<p>File: <code>her-core/main.py</code></p> <pre><code># Initialize all components:\n# 1. Load environment variables\n# 2. Initialize HERMemory\n# 3. Create agents (conversation, reflection, personality)\n# 4. Simple test: simulate a conversation, store memory, retrieve it\n# 5. Print success message with all components status\n\n# For now: just validate everything works, no Telegram yet\n</code></pre>"},{"location":"phase1_prompt/#7-configuration-files","title":"7. Configuration Files","text":"<p>File: <code>config/agents.yaml</code></p> <pre><code>conversation_agent:\n  role: \"Empathetic Conversationalist\"\n  goal: \"Engage users with warmth and context\"\n  temperature: 0.7\n  max_tokens: 500\n\nreflection_agent:\n  role: \"Memory Curator\"\n  goal: \"Preserve meaningful moments\"\n  temperature: 0.3\n  importance_threshold: 0.7\n\npersonality_agent:\n  role: \"Personality Manager\"\n  evolution_speed: \"medium\"\n  boundaries: {min: 20, max: 95}\n</code></pre> <p>File: <code>config/personality.yaml</code></p> <pre><code>default_traits:\n  warmth: 75\n  curiosity: 80\n  assertiveness: 60\n  humor: 70\n  emotional_depth: 85\n\nimmutable_values:\n  - empathy\n  - safety_awareness\n</code></pre> <p>File: <code>config/memory.yaml</code></p> <pre><code>short_term:\n  ttl: 86400  # 24 hours\n  max_messages: 20\n\nlong_term:\n  importance_threshold: 0.7\n  embedding_model: \"text-embedding-3-small\"\n  vector_dimensions: 1536\n</code></pre>"},{"location":"phase1_prompt/#8-environment-variables","title":"8. Environment Variables","text":"<p>File: <code>.env.example</code></p> <pre><code># LLM Provider (openai or groq)\nLLM_PROVIDER=openai\nOPENAI_API_KEY=sk-...\nGROQ_API_KEY=gsk_...\n\n# Database\nPOSTGRES_USER=her\nPOSTGRES_PASSWORD=changeme123\nPOSTGRES_DB=her_memory\nPOSTGRES_HOST=postgres\nPOSTGRES_PORT=5432\n\n# Redis  \nREDIS_HOST=redis\nREDIS_PORT=6379\nREDIS_PASSWORD=changeme456\n\n# App\nLOG_LEVEL=INFO\nENVIRONMENT=development\n</code></pre>"},{"location":"phase1_prompt/#9-dockerfile","title":"9. Dockerfile","text":"<p>File: <code>her-core/Dockerfile</code></p> <pre><code>FROM python:3.11-slim\n\nWORKDIR /app\n\n# Install system dependencies\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    postgresql-client \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Copy requirements and install\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\n# Copy application code\nCOPY . .\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n    CMD python -c \"import sys; sys.exit(0)\"\n\nCMD [\"python\", \"main.py\"]\n</code></pre>"},{"location":"phase1_prompt/#10-requirements","title":"10. Requirements","text":"<p>File: <code>her-core/requirements.txt</code></p> <pre><code>crewai==0.28.0\nmem0ai==0.0.9\nopenai==1.12.0\ngroq==0.4.2\npsycopg2-binary==2.9.9\nredis==5.0.1\npyyaml==6.0.1\npython-dotenv==1.0.0\npydantic==2.6.0\n</code></pre>"},{"location":"phase1_prompt/#success-criteria-phase-1-complete","title":"\u2705 Success Criteria (Phase 1 Complete)","text":"<p>When you run:</p> <pre><code>docker-compose up -d\ndocker-compose logs -f her-bot\n</code></pre> <p>You should see:</p> <pre><code>\u2713 PostgreSQL connected with pgvector enabled\n\u2713 Redis connected\n\u2713 Mem0 initialized\n\u2713 Conversation Agent created\n\u2713 Reflection Agent created  \n\u2713 Personality Agent created\n\u2713 Test: Stored memory with embedding\n\u2713 Test: Retrieved memory via semantic search\n\u2713 Test: Personality trait updated\n\ud83c\udf89 HER Phase 1 Complete - All systems operational!\n</code></pre>"},{"location":"phase1_prompt/#deliverables-checklist","title":"\ud83c\udfaf Deliverables Checklist","text":"<ul> <li>[ ] All files created with proper structure</li> <li>[ ] Docker containers start successfully</li> <li>[ ] PostgreSQL has all tables with pgvector</li> <li>[ ] Redis stores/retrieves context</li> <li>[ ] Mem0 stores/searches memories with embeddings</li> <li>[ ] All 3 CrewAI agents initialize</li> <li>[ ] Test conversation creates memories</li> <li>[ ] Semantic search returns relevant memories</li> <li>[ ] Personality traits save to database</li> <li>[ ] No errors in logs</li> </ul> <p>Build this Phase 1 foundation. Make it solid, tested, and ready for Phase 2 (Telegram Bot).</p>"},{"location":"roadmap/","title":"Future Implementation Roadmap","text":"<p>This roadmap is forward-looking and organized into three delivery phases.</p>"},{"location":"roadmap/#phase-1-short-term-next-1-3-months","title":"Phase 1 - Short-Term (Next 1-3 Months)","text":""},{"location":"roadmap/#milestones-and-deliverables","title":"Milestones and Deliverables","text":"<ol> <li>Runtime reliability hardening</li> <li>Deliverables:</li> <li>improved startup diagnostics for provider and MCP failures</li> <li> <p>clearer degraded-mode notifications in Telegram and dashboard</p> </li> <li> <p>Documentation completeness and consistency</p> </li> <li>Deliverables:</li> <li>finalized doc index and per-folder docs</li> <li>configuration examples for common provider combinations</li> <li> <p>operator runbooks for incident triage</p> </li> <li> <p>Scheduler usability improvements</p> </li> <li>Deliverables:</li> <li>richer natural-language schedule parsing coverage</li> <li>better validation/error messages for <code>/schedule add</code> workflow payloads</li> </ol>"},{"location":"roadmap/#target-enhancements","title":"Target Enhancements","text":"<ul> <li>Expand tests around autonomous sandbox loop guardrails.</li> <li>Add explicit docs for fallback pathways and recovery playbooks.</li> </ul>"},{"location":"roadmap/#phase-2-medium-term-3-6-months","title":"Phase 2 - Medium-Term (3-6 Months)","text":""},{"location":"roadmap/#major-features","title":"Major Features","text":"<ol> <li>Multi-channel interface expansion</li> <li> <p>Add additional chat channels beyond Telegram with shared memory semantics.</p> </li> <li> <p>Enhanced memory governance</p> </li> <li> <p>Add retention, archival, and user-directed memory controls.</p> </li> <li> <p>Advanced dashboard operations</p> </li> <li>Role-aware admin views and richer historical analytics.</li> </ol>"},{"location":"roadmap/#refactoring-tasks","title":"Refactoring Tasks","text":"<ul> <li>Split large Telegram handler module into domain-oriented submodules.</li> <li>Extract scheduler workflow evaluator into dedicated component with tighter typing.</li> <li>Consolidate duplicated runtime paths (<code>her-core/main.py</code> and legacy <code>her-core/telegram_bot.py</code>) behind one supported entry strategy.</li> </ul>"},{"location":"roadmap/#stability-and-performance","title":"Stability and Performance","text":"<ul> <li>Improve response latency under provider failover.</li> <li>Add load-focused runtime checks and memory query profiling.</li> </ul>"},{"location":"roadmap/#phase-3-long-term-6-12-months","title":"Phase 3 - Long-Term (6-12 Months)","text":""},{"location":"roadmap/#visionary-features","title":"Visionary Features","text":"<ol> <li>Adaptive policy engine</li> <li> <p>Policy-driven behavior tuning with explicit safety and style contracts.</p> </li> <li> <p>Plugin ecosystem for tools</p> </li> <li> <p>Structured extension model for MCP profiles and custom tools.</p> </li> <li> <p>Explainability layer</p> </li> <li>Human-readable rationale summaries for selected decisions and actions.</li> </ol>"},{"location":"roadmap/#platform-expansion","title":"Platform Expansion","text":"<ul> <li>Broader deployment targets (managed container platforms, autoscaling profiles).</li> <li>More provider presets and memory backend options.</li> </ul>"},{"location":"roadmap/#scaling-and-community","title":"Scaling and Community","text":"<ul> <li>Contributor templates for modules/tests/docs.</li> <li>Public issue labels and RFC workflow for architecture-level changes.</li> <li>Versioned documentation and migration guides for major releases.</li> </ul>"},{"location":"testing/","title":"Testing Guide","text":""},{"location":"testing/#test-scope","title":"Test Scope","text":"<p>Current tests focus on: - configuration and runtime guardrails, - regression checks for critical integration behavior, - smoke assertions for project shape and startup logic.</p> <p>Primary files: - <code>tests/test_smoke.py</code> - <code>tests/test_runtime_guards.py</code></p>"},{"location":"testing/#running-tests","title":"Running Tests","text":"<p>From repository root:</p> <pre><code>pytest -q\n</code></pre> <p>Targeted:</p> <pre><code>pytest tests/test_smoke.py -q\npytest tests/test_runtime_guards.py -q\n</code></pre>"},{"location":"testing/#runtime-validation-container-stack","title":"Runtime Validation (Container Stack)","text":"<pre><code>docker compose up -d --build\ndocker compose ps\ncurl -sS http://localhost:8000\ndocker compose logs --tail=200 her-bot\n</code></pre> <p>Sandbox diagnostics:</p> <pre><code>docker compose exec sandbox check_pentest_tools\n</code></pre>"},{"location":"testing/#how-tests-are-structured","title":"How Tests Are Structured","text":"<ul> <li>Static file assertions verify expected command registrations and safeguards.</li> <li>Config assertions ensure required sections stay present.</li> <li>Runtime behavior guarantees are encoded as source-level checks to prevent accidental removals.</li> </ul>"},{"location":"testing/#writing-new-tests","title":"Writing New Tests","text":"<ol> <li>Add tests under <code>tests/</code> using <code>pytest</code> style.</li> <li>Prefer behavior-oriented assertions over implementation noise.</li> <li>For config and docs impacting behavior, add guard tests that protect critical expectations.</li> <li>Run full suite before PR.</li> </ol>"},{"location":"testing/#ci-integration","title":"CI Integration","text":"<p>GitHub Actions workflow (<code>.github/workflows/ci.yml</code>) runs: 1. Python setup 2. dependencies install 3. <code>pytest -q</code> 4. build/push container images (non-PR push paths) 5. docs build/deploy from <code>main</code></p>"},{"location":"testing_playbook/","title":"HER Capability Testing Playbook (Step-by-Step)","text":"<p>Use this guide to validate HER end-to-end after startup. It is intentionally hands-on and organized by capability.</p>"},{"location":"testing_playbook/#0-prerequisites","title":"0) Prerequisites","text":"<ul> <li><code>.env</code> configured (at minimum: <code>TELEGRAM_BOT_TOKEN</code>, <code>ADMIN_USER_ID</code>, provider keys/settings, DB/Redis passwords).</li> <li>Docker daemon running.</li> <li>You are at repository root.</li> </ul>"},{"location":"testing_playbook/#1-bring-the-stack-up","title":"1) Bring the stack up","text":"<pre><code>docker compose up -d --build\n</code></pre> <p>Then check runtime health:</p> <pre><code>docker compose ps\ndocker compose logs --tail=100 her-bot\n</code></pre>"},{"location":"testing_playbook/#expected","title":"Expected","text":"<ul> <li><code>her-bot</code>, <code>postgres</code>, <code>redis</code>, <code>dashboard</code> are up.</li> <li><code>her-bot</code> logs include startup milestones for memory + agent initialization.</li> </ul>"},{"location":"testing_playbook/#2-validate-http-health-endpoint","title":"2) Validate HTTP health endpoint","text":"<pre><code>curl -sS http://localhost:8000\n</code></pre>"},{"location":"testing_playbook/#expected_1","title":"Expected","text":"<pre><code>{\"status\": \"ok\"}\n</code></pre>"},{"location":"testing_playbook/#3-validate-telegram-baseline-behavior","title":"3) Validate Telegram baseline behavior","text":"<p>Open your bot in Telegram and execute these tests in order.</p>"},{"location":"testing_playbook/#31-start-works","title":"3.1 <code>/start</code> works","text":"<p>Send:</p> <pre><code>/start\n</code></pre> <p>Expected: - Welcome message. - If your Telegram user ID is in admin list, an admin inline menu appears.</p>"},{"location":"testing_playbook/#32-help-returns-mode-appropriate-commands","title":"3.2 <code>/help</code> returns mode-appropriate commands","text":"<p>Send:</p> <pre><code>/help\n</code></pre> <p>Expected: - Admin sees admin command list. - Public user sees public command list.</p>"},{"location":"testing_playbook/#321-example-returns-prompt-library-topics","title":"3.2.1 <code>/example</code> returns prompt library topics","text":"<p>Send:</p> <pre><code>/example\n</code></pre> <p>Expected: - Bot returns topic list and usage (<code>/example &lt;topic&gt;</code>, <code>/example all</code>). - Response includes examples for scheduling/automation.</p>"},{"location":"testing_playbook/#33-language-alignment-context-continuity","title":"3.3 Language alignment + context continuity","text":"<p>Send:</p> <pre><code>Hello HER, can you remember that I like jasmine tea?\n</code></pre> <p>Expected: - Bot response language matches the user's message language. - Context continuity is preserved in follow-ups (no per-message reset).</p> <p>Send immediately after:</p> <pre><code>call Ali\n</code></pre> <p>Expected: - Follow-up is treated as a new actionable task (not ignored). - Scheduler/handler path creates a new task or action using prior context. - Confirmation remains in the same user language.</p>"},{"location":"testing_playbook/#4-validate-admin-command-set","title":"4) Validate admin command set","text":"<p>Run as admin user.</p>"},{"location":"testing_playbook/#41-status","title":"4.1 <code>/status</code>","text":"<p>Expected: - Status response is returned. - Includes MCP status block when MCP manager is loaded.</p>"},{"location":"testing_playbook/#42-personality","title":"4.2 <code>/personality</code>","text":"<p>Expected: - Inline keyboard for personality adjustments is displayed.</p>"},{"location":"testing_playbook/#43-memories","title":"4.3 <code>/memories</code>","text":"<p>Expected: - Response includes recent context/memory info.</p>"},{"location":"testing_playbook/#44-mcp","title":"4.4 <code>/mcp</code>","text":"<p>Expected: - MCP server status payload returned (running/failed/disabled per server).</p>"},{"location":"testing_playbook/#45-reset","title":"4.5 <code>/reset</code>","text":"<p>Expected: - Reset acknowledgement is returned.</p>"},{"location":"testing_playbook/#46-schedule","title":"4.6 <code>/schedule</code>","text":"<p>Run:</p> <pre><code>/schedule list\n</code></pre> <p>Expected: - Scheduled tasks list is returned with interval and enabled state.</p> <p>Run:</p> <pre><code>/schedule run memory_reflection\n</code></pre> <p>Expected: - Immediate execution acknowledgement is returned.</p> <p>Run (generic workflow rule):</p> <pre><code>/schedule add btc_rule workflow every_5_minutes source_url=https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&amp;vs_currencies=usd steps_json='[{\"action\":\"set\",\"key\":\"price\",\"expr\":\"float(source[\\\"bitcoin\\\"][\\\"usd\\\"])\"},\n{\"action\":\"notify\",\"when\":\"state.get(\\\"last_price\\\") and ((price-float(state[\\\"last_price\\\"]))/float(state[\\\"last_price\\\"])*100)&gt;=2\",\"message\":\"BTC up &gt;=2%, price={price}\"},\n{\"action\":\"set_state\",\"key\":\"last_price\",\"expr\":\"price\"}]'\n</code></pre> <p>Expected: - Task is created and persisted. - Task executes as a chain without introducing new hardcoded task logic.</p>"},{"location":"testing_playbook/#47-natural-language-scheduling-no-slash-command","title":"4.7 Natural-language scheduling (no slash command)","text":"<p>Send:</p> <pre><code>Remind me to stretch in 15 minutes\n</code></pre> <p>Expected: - HER confirms in the user's language. - Confirmation format starts with <code>\u2705</code>. - Confirmation references the original request and includes clear time context. - A one-time scheduler task is created internally and persisted.</p> <p>Send:</p> <pre><code>Remind me every day at 9am to review my goals\n</code></pre> <p>Expected: - HER confirms recurring reminder setup in the same user language. - Task appears in dashboard Jobs page under Upcoming Jobs.</p> <p>Send:</p> <pre><code>Check BTC price every 2 minutes and notify me when it is 10% above the current price\n</code></pre> <p>Expected: - HER handles both intents sequentially if present in one message. - A workflow task is created with interval + condition steps and appears in <code>/schedule list</code>.</p> <p>Send multilingual switch test:</p> <pre><code>Recu\u00e9rdame en 10 minutos llamar a Sara\n</code></pre> <p>Expected: - HER switches to Spanish confirmation immediately. - A one-time reminder task is created and persisted.</p> <p>Send:</p> <pre><code>That was perfect, thank you.\n</code></pre> <p>Expected: - Reinforcement logs record approval (<code>her:reinforcement:events</code> and Decisions page). - A reinforcement lesson entry is persisted in long-term memory category <code>reinforcement_lesson</code>.</p> <p>Run (time-based reminder):</p> <pre><code>/schedule add hydrate reminder daily at=09:00 timezone=UTC message='Hydration reminder: drink water now.'\n</code></pre> <p>Expected: - Reminder task is created with <code>at</code> and <code>timezone</code>. - <code>/schedule list</code> shows a computed <code>next=</code> timestamp. - Dashboard Jobs page shows the task under Upcoming Jobs.</p>"},{"location":"testing_playbook/#5-validate-public-mode-throttling","title":"5) Validate public-mode throttling","text":"<p>Run as non-admin user.</p> <ul> <li>Send messages quickly (more than configured per-minute cap in <code>config/rate_limits.yaml</code>).</li> </ul> <p>Expected: - Messages above threshold are rejected with rate-limit notice.</p>"},{"location":"testing_playbook/#6-validate-mcp-backed-capabilities","title":"6) Validate MCP-backed capabilities","text":""},{"location":"testing_playbook/#61-confirm-configured-servers","title":"6.1 Confirm configured servers","text":"<pre><code>sed -n '1,200p' config/mcp_servers.yaml\n</code></pre> <p>Expected: - <code>fetch</code>, <code>filesystem</code>, <code>postgres</code>, <code>memory</code>, <code>sequential-thinking</code>, and <code>pdf</code> enabled by default. - <code>brave-search</code> and <code>puppeteer</code> disabled by default unless you explicitly enable them.</p>"},{"location":"testing_playbook/#62-web-search-intent-test-telegram","title":"6.2 Web-search intent test (Telegram)","text":"<p>Send:</p> <pre><code>Search the web for latest AI safety news and summarize in 3 bullets.\n</code></pre> <p>Expected: - Bot returns a concise summary. - If MCP web search server fails to start, status should reveal failure reason.</p>"},{"location":"testing_playbook/#63-file-operation-intent-test-if-wired-into-your-runtime-prompts","title":"6.3 File operation intent test (if wired into your runtime prompts)","text":"<p>Send:</p> <pre><code>Read /workspace/notes.txt and summarize it.\n</code></pre> <p>Expected: - If file tool is available to the active path, reply includes file summary. - If unavailable, bot should fail gracefully and continue responding.</p>"},{"location":"testing_playbook/#64-sandbox-penetrationnetwork-tool-availability","title":"6.4 Sandbox penetration/network tool availability","text":"<p>Run:</p> <pre><code>docker compose exec sandbox check_pentest_tools\n</code></pre> <p>Expected: - Command exits with code <code>0</code>. - Output includes: <code>All required penetration/network tools are available.</code> - Output shows versions for tools such as <code>nmap</code>, <code>openssl</code>, <code>curl</code>, and <code>dig</code>.</p>"},{"location":"testing_playbook/#65-telegram-sandbox-scan-execution-path","title":"6.5 Telegram sandbox scan execution path","text":"<p>Send:</p> <pre><code>Run a basic port scan summary for vaheed.net\n</code></pre> <p>Expected: - Bot does not answer with \"I can't run scans/tools\" when sandbox capability is available. - Bot returns a sandbox execution summary (success/failure, findings/errors, execution time). - Dashboard <code>Executors</code> page shows a new sandbox execution record.</p>"},{"location":"testing_playbook/#7-validate-dashboard-visibility","title":"7) Validate dashboard visibility","text":"<p>Open:</p> <ul> <li><code>http://localhost:8501</code></li> </ul> <p>Expected: - Dashboard loads. - Core service health/metrics are visible. - Jobs page includes Upcoming Jobs (from <code>her:scheduler:state</code>). - Decisions page includes runtime decision events (<code>her:decision:logs</code>). - Decisions include <code>reinforcement_event</code> and weekly <code>weekly_self_optimization</code> entries over time.</p>"},{"location":"testing_playbook/#8-negative-path-checks","title":"8) Negative-path checks","text":""},{"location":"testing_playbook/#81-telegram-token-missing","title":"8.1 Telegram token missing","text":"<p>Set <code>TELEGRAM_BOT_TOKEN</code> empty and restart <code>her-bot</code>.</p> <p>Expected: - Service should stay up without polling. - Logs warn that token is missing.</p>"},{"location":"testing_playbook/#82-memory-backend-pressure","title":"8.2 Memory backend pressure","text":"<p>Simulate low-memory model or broken provider config.</p> <p>Expected: - With fail-open memory mode, HER still replies using short-term context. - Warnings appear in logs rather than hard crash.</p>"},{"location":"testing_playbook/#9-quick-regression-checklist","title":"9) Quick regression checklist","text":"<ul> <li>[ ] <code>docker compose ps</code> all required services healthy.</li> <li>[ ] <code>/start</code> and <code>/help</code> work.</li> <li>[ ] Admin commands return responses.</li> <li>[ ] Public throttling triggers when expected.</li> <li>[ ] <code>/mcp</code> reports server statuses.</li> <li>[ ] <code>/schedule list</code> returns configured tasks.</li> <li>[ ] Dashboard reachable at <code>:8501</code>.</li> <li>[ ] No crash loops in <code>docker compose logs her-bot</code>.</li> </ul>"},{"location":"testing_playbook/#notes","title":"Notes","text":"<ul> <li>For runtime behavior details and current file locations, see <code>README.md</code> and <code>docs/mcp_guide.md</code>.</li> <li>For planned/unfinished work, see <code>docs/roadmap.md</code>.</li> </ul>"},{"location":"usage/","title":"Usage Guide","text":""},{"location":"usage/#runtime-interfaces","title":"Runtime Interfaces","text":"<ul> <li>Telegram bot for user/admin interactions (<code>her-core/her_telegram/handlers.py</code>)</li> <li>Streamlit dashboard for operations (<code>dashboard/app.py</code>)</li> <li>OpenAPI adapter for external chat UIs (<code>her-core/api_adapter/server.py</code>)</li> </ul>"},{"location":"usage/#basic-user-workflow","title":"Basic User Workflow","text":"<ol> <li>Send <code>/start</code></li> <li>Ask a normal question</li> <li>Continue conversation to leverage memory context</li> </ol> <p>Example:</p> <pre><code>User: I prefer concise replies.\nUser: Help me plan my day.\n</code></pre>"},{"location":"usage/#admin-workflow","title":"Admin Workflow","text":"<p>Admin commands: - <code>/status</code> - <code>/personality</code> - <code>/memories</code> - <code>/reflect</code> - <code>/reset</code> - <code>/mcp</code> - <code>/schedule ...</code> - <code>/example ...</code></p> <p>Examples:</p> <pre><code>/schedule list\n/schedule run memory_reflection\n/schedule add hydrate reminder daily at=09:00 timezone=UTC message='Drink water' notify_user_id=123456789\n</code></pre>"},{"location":"usage/#natural-language-scheduling","title":"Natural-Language Scheduling","text":"<p>HER parses scheduling intents from regular messages.</p> <p>Examples: - <code>Remind me in 30 minutes to submit the report.</code> - <code>Every weekday at 08:30 remind me to plan priorities.</code> - <code>Check BTC every 5 minutes and notify me if it rises 10%.</code></p>"},{"location":"usage/#tooling-and-sandbox-examples","title":"Tooling and Sandbox Examples","text":"<p>Examples: - <code>Check SSL certificate expiry for github.com.</code> - <code>Run DNS lookup for openai.com.</code> - <code>Inspect headers for https://example.com.</code></p> <p>These flow through MCP and/or sandbox tools in <code>her-core/her_mcp/tools.py</code> and <code>her-core/her_mcp/sandbox_tools.py</code>.</p>"},{"location":"usage/#language-and-continuity-behavior","title":"Language and Continuity Behavior","text":"<p>Current handlers include: - conversation-context continuity, - multilingual request handling, - language-aligned confirmations for scheduling and automation flows.</p> <p>Reference implementation: <code>her-core/her_telegram/handlers.py</code>.</p>"},{"location":"usage/#dashboard-workflow","title":"Dashboard Workflow","text":"<p>Open <code>http://localhost:8501</code> and use pages for: - Overview/metrics - Logs - Executors - Jobs - Decisions - Memory - Health</p> <p>Detailed operations: <code>docs/admin-tooling.md</code>.</p>"},{"location":"usage/#openai-compatible-api-workflow","title":"OpenAI-Compatible API Workflow","text":"<p>Use base URL:</p> <pre><code>http://localhost:8082\n</code></pre> <p>Model discovery:</p> <pre><code>curl -sS http://localhost:8082/v1/models \\\n  -H \"Authorization: Bearer $API_ADAPTER_BEARER_TOKEN\"\n</code></pre> <p>Chat completion:</p> <pre><code>curl -sS http://localhost:8082/v1/chat/completions \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer $API_ADAPTER_BEARER_TOKEN\" \\\n  -d '{\"model\":\"her-chat-1\",\"messages\":[{\"role\":\"user\",\"content\":\"run mtr on vaheed.net\"}]}'\n</code></pre> <p>Streaming completion:</p> <pre><code>curl -N http://localhost:8082/v1/chat/completions \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer $API_ADAPTER_BEARER_TOKEN\" \\\n  -d '{\"model\":\"her-chat-1\",\"stream\":true,\"messages\":[{\"role\":\"user\",\"content\":\"hello\"}]}'\n</code></pre>"},{"location":"folders/config/","title":"Folder Reference: config","text":""},{"location":"folders/config/#purpose","title":"Purpose","text":"<p>Central YAML configuration files for agent behavior, memory, Telegram features, scheduler tasks, and MCP profiles.</p>"},{"location":"folders/config/#files","title":"Files","text":"<ul> <li><code>config/agents.yaml</code></li> <li><code>config/personality.yaml</code></li> <li><code>config/memory.yaml</code></li> <li><code>config/telegram.yaml</code></li> <li><code>config/rate_limits.yaml</code></li> <li><code>config/scheduler.yaml</code></li> <li><code>config/mcp_servers.yaml</code></li> <li><code>config/mcp_servers.local.yaml</code></li> <li><code>config/twitter.yaml</code></li> </ul>"},{"location":"folders/config/#runtime-resolution","title":"Runtime Resolution","text":"<p>Config file discovery is implemented in <code>her-core/utils/config_paths.py</code>, respecting <code>HER_CONFIG_DIR</code> and container defaults.</p>"},{"location":"folders/config/#validation","title":"Validation","text":"<ul> <li>Static coverage in tests (<code>tests/test_smoke.py</code>, <code>tests/test_runtime_guards.py</code>)</li> <li>Runtime checks via <code>/status</code>, <code>/mcp</code>, and dashboard health pages</li> </ul>"},{"location":"folders/dashboard/","title":"Folder Reference: dashboard","text":""},{"location":"folders/dashboard/#purpose","title":"Purpose","text":"<p>Streamlit-based operational dashboard for monitoring runtime activity.</p>"},{"location":"folders/dashboard/#files","title":"Files","text":"<ul> <li><code>dashboard/app.py</code> - full dashboard UI and data queries</li> <li><code>dashboard/requirements.txt</code> - dashboard dependencies</li> <li><code>dashboard/Dockerfile</code> - dashboard image build</li> </ul>"},{"location":"folders/dashboard/#behavior","title":"Behavior","text":"<p>Dashboard reads Redis keys for logs/metrics/runtime state and PostgreSQL for memory statistics/search.</p>"},{"location":"folders/dashboard/#how-to-run-and-test","title":"How to Run and Test","text":"<pre><code>docker compose up -d dashboard\n</code></pre> <p>Access: - <code>http://localhost:8501</code></p> <p>Validate logs:</p> <pre><code>docker compose logs --tail=200 dashboard\n</code></pre>"},{"location":"folders/docs/","title":"Folder Reference: docs","text":""},{"location":"folders/docs/#purpose","title":"Purpose","text":"<p>Project documentation set for users, operators, and contributors.</p>"},{"location":"folders/docs/#contents","title":"Contents","text":"<ul> <li>system docs (<code>architecture</code>, <code>installation</code>, <code>configuration</code>, <code>usage</code>, <code>testing</code>, <code>deployment</code>)</li> <li>operational docs (<code>admin-tooling</code>, <code>mcp_guide</code>)</li> <li>process docs (<code>developer-guidelines</code>, <code>roadmap</code>)</li> <li>module/folder references (<code>docs/folders/*.md</code>)</li> </ul>"},{"location":"folders/docs/#publishing","title":"Publishing","text":"<p>Site build configuration is in <code>mkdocs.yml</code>, and deployment runs in <code>.github/workflows/ci.yml</code>.</p>"},{"location":"folders/docs/#validation","title":"Validation","text":"<pre><code>mkdocs build --strict\n</code></pre>"},{"location":"folders/github-workflows/","title":"Folder Reference: .github/workflows","text":""},{"location":"folders/github-workflows/#purpose","title":"Purpose","text":"<p>CI/CD automation for tests, image builds, and docs deployment.</p>"},{"location":"folders/github-workflows/#files","title":"Files","text":"<ul> <li><code>.github/workflows/ci.yml</code></li> </ul>"},{"location":"folders/github-workflows/#pipeline-summary","title":"Pipeline Summary","text":"<ol> <li>Test job (<code>pytest -q</code>)</li> <li>Multi-image build/push to GHCR (<code>her-bot</code>, <code>her-dashboard</code>, <code>her-sandbox</code>)</li> <li>MkDocs build and GitHub Pages deployment on <code>main</code></li> </ol>"},{"location":"folders/github-workflows/#validation","title":"Validation","text":"<p>Check workflow runs in GitHub Actions and verify published images/docs artifacts after successful pipelines.</p>"},{"location":"folders/her-core-agents/","title":"Code Area: her-core/agents","text":""},{"location":"folders/her-core-agents/#purpose","title":"Purpose","text":"<p>Defines CrewAI agent roles and orchestration wiring.</p>"},{"location":"folders/her-core-agents/#files","title":"Files","text":"<ul> <li><code>her-core/agents/base_agent.py</code> - shared config load + LLM wiring</li> <li><code>her-core/agents/conversation_agent.py</code> - user-facing conversational behavior</li> <li><code>her-core/agents/reflection_agent.py</code> - memory curation behavior</li> <li><code>her-core/agents/personality_agent.py</code> - personality trait management</li> <li><code>her-core/agents/tool_agent.py</code> - tool execution role</li> <li><code>her-core/agents/crew_orchestrator.py</code> - task definitions + crew composition</li> </ul>"},{"location":"folders/her-core-agents/#how-to-test","title":"How to Test","text":"<pre><code>pytest tests/test_smoke.py -q\npytest tests/test_runtime_guards.py -q\n</code></pre>"},{"location":"folders/her-core-mcp/","title":"Code Area: her-core/her_mcp","text":""},{"location":"folders/her-core-mcp/#purpose","title":"Purpose","text":"<p>Manages MCP server startup, availability tracking, and tool exposure to runtime agents.</p>"},{"location":"folders/her-core-mcp/#files","title":"Files","text":"<ul> <li><code>her-core/her_mcp/manager.py</code> - process lifecycle, env expansion, status tracking</li> <li><code>her-core/her_mcp/tools.py</code> - curated tools and capability probing</li> <li><code>her-core/her_mcp/helpers.py</code> - async helper functions</li> <li><code>her-core/her_mcp/sandbox_tools.py</code> - sandbox command/web/network/security tools</li> <li><code>her-core/her_mcp/twitter_tools.py</code> - optional twitter integration tools</li> </ul>"},{"location":"folders/her-core-mcp/#how-to-test","title":"How to Test","text":"<pre><code>pytest tests/test_runtime_guards.py -q\n</code></pre>"},{"location":"folders/her-core-memory/","title":"Code Area: her-core/memory","text":""},{"location":"folders/her-core-memory/#purpose","title":"Purpose","text":"<p>Implements long-term memory integration (Mem0 + pgvector) and short-term conversation context storage (Redis).</p>"},{"location":"folders/her-core-memory/#files","title":"Files","text":"<ul> <li><code>her-core/memory/mem0_client.py</code> - memory add/search/update/delete wrapper</li> <li><code>her-core/memory/redis_client.py</code> - context cache API</li> <li><code>her-core/memory/db_init.py</code> - schema initialization helper</li> <li><code>her-core/memory/schemas.sql</code> - database schema and compatibility migrations</li> <li><code>her-core/memory/fallback_memory.py</code> - degraded-mode in-process memory behavior</li> </ul>"},{"location":"folders/her-core-memory/#how-to-test","title":"How to Test","text":"<pre><code>pytest tests/test_runtime_guards.py -q\n</code></pre>"},{"location":"folders/her-core-telegram/","title":"Code Area: her-core/her_telegram","text":""},{"location":"folders/her-core-telegram/#purpose","title":"Purpose","text":"<p>Telegram interface layer, including command handlers, access control behavior, scheduling UX, and autonomous sandbox loop integration.</p>"},{"location":"folders/her-core-telegram/#files","title":"Files","text":"<ul> <li><code>her-core/her_telegram/bot.py</code> - telegram app handler registration</li> <li><code>her-core/her_telegram/handlers.py</code> - command + message handling logic</li> <li><code>her-core/her_telegram/autonomous_operator.py</code> - JSON action execution loop</li> <li><code>her-core/her_telegram/unified_interpreter.py</code> - interpretation helper</li> <li><code>her-core/her_telegram/keyboards.py</code> - inline keyboard helpers</li> <li><code>her-core/her_telegram/rate_limiter.py</code> - rate limiting</li> </ul>"},{"location":"folders/her-core-telegram/#how-it-works","title":"How It Works","text":"<p>Incoming Telegram updates are routed to <code>MessageHandlers</code>, which manages admin/public paths, memory updates, LLM responses, scheduling intents, and tool actions.</p>"},{"location":"folders/her-core-telegram/#how-to-test","title":"How to Test","text":"<pre><code>pytest tests/test_runtime_guards.py -q\n</code></pre>"},{"location":"folders/her-core-utils/","title":"Code Area: her-core/utils","text":""},{"location":"folders/her-core-utils/#purpose","title":"Purpose","text":"<p>Shared runtime services: scheduler, retries, metrics, decision logs, reinforcement scoring, and config resolution.</p>"},{"location":"folders/her-core-utils/#files","title":"Files","text":"<ul> <li><code>her-core/utils/scheduler.py</code></li> <li><code>her-core/utils/schedule_helpers.py</code></li> <li><code>her-core/utils/llm_factory.py</code></li> <li><code>her-core/utils/retry.py</code></li> <li><code>her-core/utils/metrics.py</code></li> <li><code>her-core/utils/decision_log.py</code></li> <li><code>her-core/utils/reinforcement.py</code></li> <li><code>her-core/utils/config_paths.py</code></li> <li><code>her-core/utils/telegram_access.py</code></li> </ul>"},{"location":"folders/her-core-utils/#how-to-test","title":"How to Test","text":"<pre><code>pytest tests/test_runtime_guards.py -q\n</code></pre>"},{"location":"folders/her-core/","title":"Folder Reference: her-core","text":""},{"location":"folders/her-core/#purpose","title":"Purpose","text":"<p>Main runtime package for HER-Ai.</p>"},{"location":"folders/her-core/#structure","title":"Structure","text":"<ul> <li><code>her-core/main.py</code> - async bootstrap, memory init, MCP init, scheduler start, Telegram startup</li> <li><code>her-core/config.py</code> - environment-backed app config dataclass</li> <li><code>her-core/agents/</code> - CrewAI agent definitions and crew orchestration</li> <li><code>her-core/her_telegram/</code> - bot wiring, commands, message handlers, autonomous operator</li> <li><code>her-core/her_mcp/</code> - MCP manager and tool wrappers (including sandbox and optional twitter)</li> <li><code>her-core/memory/</code> - Mem0 integration, Redis context store, DB init/schema</li> <li><code>her-core/utils/</code> - LLM factory, scheduler, retry, metrics, decision log, reinforcement logic</li> <li><code>her-core/docker-entrypoint.sh</code> - runtime config seeding/fallback behavior</li> </ul>"},{"location":"folders/her-core/#how-it-works","title":"How It Works","text":"<p><code>main.py</code> wires memory + tools + agents + scheduler + Telegram handlers, publishes capability snapshots, then runs indefinitely.</p>"},{"location":"folders/her-core/#how-to-test","title":"How to Test","text":"<pre><code>pytest tests/test_smoke.py -q\npytest tests/test_runtime_guards.py -q\n</code></pre> <p>Runtime verification:</p> <pre><code>docker compose logs --tail=200 her-bot\n</code></pre>"},{"location":"folders/init-scripts/","title":"Folder Reference: init-scripts","text":""},{"location":"folders/init-scripts/#purpose","title":"Purpose","text":"<p>Database initialization SQL for PostgreSQL container startup.</p>"},{"location":"folders/init-scripts/#files","title":"Files","text":"<ul> <li><code>init-scripts/init-db.sql</code></li> </ul>"},{"location":"folders/init-scripts/#what-it-sets-up","title":"What It Sets Up","text":"<ul> <li>required extensions (<code>vector</code>, <code>pgcrypto</code>)</li> <li>users/personality/conversation/decision/reinforcement tables</li> <li>compatibility migration logic for legacy <code>memories</code> table shapes</li> </ul>"},{"location":"folders/init-scripts/#validation","title":"Validation","text":"<p>Start DB and inspect logs:</p> <pre><code>docker compose up -d postgres\ndocker compose logs --tail=100 postgres\n</code></pre>"},{"location":"folders/sandbox/","title":"Folder Reference: sandbox","text":""},{"location":"folders/sandbox/#purpose","title":"Purpose","text":"<p>Container image and utilities for isolated command execution and diagnostics.</p>"},{"location":"folders/sandbox/#files","title":"Files","text":"<ul> <li><code>sandbox/Dockerfile</code> - sandbox environment definition</li> <li><code>sandbox/check_pentest_tools.sh</code> - quick tool availability check script</li> </ul>"},{"location":"folders/sandbox/#capabilities","title":"Capabilities","text":"<p>Includes tools such as: - network diagnostics (<code>ping</code>, <code>traceroute</code>, <code>dnsutils</code>, <code>netcat</code>) - security/inspection utilities (<code>nmap</code>, <code>openssl</code>, <code>whois</code>) - Node/npm MCP packages for local no-key profile</p>"},{"location":"folders/sandbox/#test","title":"Test","text":"<pre><code>docker compose exec sandbox check_pentest_tools\n</code></pre>"},{"location":"folders/tests/","title":"Folder Reference: tests","text":""},{"location":"folders/tests/#purpose","title":"Purpose","text":"<p>Regression and runtime guard tests for critical behavior.</p>"},{"location":"folders/tests/#files","title":"Files","text":"<ul> <li><code>tests/test_smoke.py</code> - baseline config and structural checks</li> <li><code>tests/test_runtime_guards.py</code> - guardrails around Telegram, scheduler, MCP, memory, fallback behavior</li> </ul>"},{"location":"folders/tests/#execution","title":"Execution","text":"<pre><code>pytest -q\n</code></pre>"},{"location":"folders/tests/#notes","title":"Notes","text":"<p>Tests intentionally include source-level assertions to prevent silent removal of critical safety and reliability paths.</p>"}]}